{"openapi":"3.1.0","info":{"title":"Captide REST API","description":"\n    API for performing RAG on SEC filings, financial reports, and earnings call data with source linking capabilities.\n    \n    ## API Conventions\n    \n    - All JSON request and response fields use **camelCase** naming (e.g., `sourceType`, `fiscalPeriod`, `documentId`)\n    - URL paths follow **kebab-case** convention (e.g., `/api/v1/rag/agent-query-stream`)\n    - Date format: ISO 8601 (YYYY-MM-DD)\n    - Authentication: API key via X-API-Key header\n    ","version":"1.0.2"},"paths":{"/api/v1/companies/search":{"get":{"tags":["Companies"],"summary":"Search Companies","description":"Search companies by name or ticker symbol.\n\nDesigned for typeahead search as users type in a search field. Returns a list of matching companies\nwith their names, ticker symbols, exchange, and CIK.\n\n- **query**: Text to search for in company names or tickers (case-insensitive partial match)\n- **includeDelisted**: Whether to include delisted companies in search results\n- **limit**: Maximum number of results to return (defaults to 10)\n\n*Note: All JSON fields use camelCase naming convention.*","operationId":"search_companies_api_v1_companies_search_get","security":[{"ApiKeyAuth":[]}],"parameters":[{"name":"query","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Search by company name or ticker (partial match)","title":"Query"},"description":"Search by company name or ticker (partial match)"},{"name":"includeDelisted","in":"query","required":false,"schema":{"anyOf":[{"type":"boolean"},{"type":"null"}],"description":"Include delisted companies in results","default":false,"title":"Includedelisted"},"description":"Include delisted companies in results"},{"name":"limit","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"description":"Maximum number of records to return","default":10,"title":"Limit"},"description":"Maximum number of records to return"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CompanyListResponse"},"title":"Response Search Companies Api V1 Companies Search Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/companies":{"get":{"tags":["Companies"],"summary":"List Companies","description":"List all available companies, optionally filtered by name or ticker.\n\n- **name**: Optional filter for company name (case-insensitive partial match)\n- **ticker**: Optional filter for exact ticker symbol match (case-insensitive)\n- **includeDelisted**: Whether to include delisted companies\n- **limit**: Maximum number of records to return (defaults to 100)\n\n*Note: All JSON fields use camelCase naming convention.*","operationId":"list_companies_api_v1_companies_get","security":[{"ApiKeyAuth":[]}],"parameters":[{"name":"name","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter companies by name (partial match)","title":"Name"},"description":"Filter companies by name (partial match)"},{"name":"ticker","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter companies by exact ticker symbol match","title":"Ticker"},"description":"Filter companies by exact ticker symbol match"},{"name":"includeDelisted","in":"query","required":false,"schema":{"anyOf":[{"type":"boolean"},{"type":"null"}],"description":"Include delisted companies","default":false,"title":"Includedelisted"},"description":"Include delisted companies"},{"name":"limit","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"description":"Maximum number of records to return","default":100,"title":"Limit"},"description":"Maximum number of records to return"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CompanyListResponse"},"title":"Response List Companies Api V1 Companies Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/companies/ticker/{ticker}/documents/search":{"get":{"tags":["Companies"],"summary":"Search Company Documents By Ticker","description":"Search for documents related to a company by ticker symbol.\n\nIdeal for building a document selector interface where users can search for specific documents\nto analyze, and then pass the document IDs to the RAG API for focused analysis.\n\n- **ticker**: Ticker symbol of the company\n- **query**: Optional text to search for in document metadata or to detect document type\n  Examples:\n  - \"10k\" or \"annual\" to find 10-K reports\n  - \"quarterly\" or \"10q\" to find 10-Q reports  \n  - \"transcript\" or \"call\" to find earnings call transcripts\n  - \"8k\" to find 8-K filings\n  - \"proxy\" or \"14a\" to find proxy statements\n- **documentTypes**: Optional explicit filter for specific document types\n- **startDate**: Optional start date filter (YYYY-MM-DD)\n- **endDate**: Optional end date filter (YYYY-MM-DD)\n- **limit**: Maximum number of results to return (default: 50)\n\n*Note: All JSON fields use camelCase naming convention.*","operationId":"search_company_documents_by_ticker_api_v1_companies_ticker__ticker__documents_search_get","security":[{"ApiKeyAuth":[]}],"parameters":[{"name":"ticker","in":"path","required":true,"schema":{"type":"string","title":"Ticker"}},{"name":"query","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Text to search for in document metadata","title":"Query"},"description":"Text to search for in document metadata"},{"name":"documentTypes","in":"query","required":false,"schema":{"anyOf":[{"type":"array","items":{"type":"string"}},{"type":"null"}],"description":"Filter by document types: '10-K', '10-Q', '8-K', 'transcript', 'DEF 14A'","title":"Documenttypes"},"description":"Filter by document types: '10-K', '10-Q', '8-K', 'transcript', 'DEF 14A'"},{"name":"startDate","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter documents after this date (YYYY-MM-DD)","title":"Startdate"},"description":"Filter documents after this date (YYYY-MM-DD)"},{"name":"endDate","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter documents before this date (YYYY-MM-DD)","title":"Enddate"},"description":"Filter documents before this date (YYYY-MM-DD)"},{"name":"limit","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"description":"Maximum number of records to return","default":50,"title":"Limit"},"description":"Maximum number of records to return"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/SourceDocument"},"title":"Response Search Company Documents By Ticker Api V1 Companies Ticker  Ticker  Documents Search Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/companies/ticker/{ticker}/documents":{"get":{"tags":["Companies"],"summary":"List Company Documents By Ticker","description":"List all documents for a company identified by ticker symbol.\n\nReturns documents in chronological order (newest first).\n\n- **ticker**: Ticker symbol of the company\n- **documentTypes**: Optional filter for specific document types\n- **startDate**: Optional start date filter (YYYY-MM-DD)\n- **endDate**: Optional end date filter (YYYY-MM-DD)\n- **limit**: Maximum number of results to return (default: 50)\n\n*Note: All JSON fields use camelCase naming convention.*","operationId":"list_company_documents_by_ticker_api_v1_companies_ticker__ticker__documents_get","security":[{"ApiKeyAuth":[]}],"parameters":[{"name":"ticker","in":"path","required":true,"schema":{"type":"string","title":"Ticker"}},{"name":"documentTypes","in":"query","required":false,"schema":{"anyOf":[{"type":"array","items":{"type":"string"}},{"type":"null"}],"description":"Filter by document types: '10-K', '10-Q', '8-K', 'transcript', 'DEF 14A'","title":"Documenttypes"},"description":"Filter by document types: '10-K', '10-Q', '8-K', 'transcript', 'DEF 14A'"},{"name":"startDate","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter documents after this date (YYYY-MM-DD)","title":"Startdate"},"description":"Filter documents after this date (YYYY-MM-DD)"},{"name":"endDate","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter documents before this date (YYYY-MM-DD)","title":"Enddate"},"description":"Filter documents before this date (YYYY-MM-DD)"},{"name":"limit","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"description":"Maximum number of records to return","default":50,"title":"Limit"},"description":"Maximum number of records to return"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/SourceDocument"},"title":"Response List Company Documents By Ticker Api V1 Companies Ticker  Ticker  Documents Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/document":{"get":{"tags":["Documents"],"summary":"Get Document","description":"Retrieves a source document for display in the frontend.\n\nNOTE: Consuming applications should NOT use this endpoint directly. Instead, they should \nuse the `sourceLink` URLs returned by other endpoints (like `/rag/agent-query-stream` or `/rag/chunks`).\nThis endpoint is documented here purely for reference purposes.\n\nThis endpoint is designed to be called when a consuming application has received\na response containing a `sourceLink` from other endpoints (like `/rag/agent-query-stream` \nor `/rag/chunks`). It returns the full HTML content and metadata of the referenced \ndocument for display and highlighting in the frontend.\n\nSupported document types:\n- SEC filings (10-K, 10-Q)\n- International SEC filings (20-F, 40-F, 6-K)\n- 8-K documents (with embedded images)\n- Earnings call transcripts\n- Proxy statements (DEF 14A, DEFM14A, DEF 14C, DEFM14C, etc.)\n\n*Note: All JSON fields use camelCase naming convention.*","operationId":"get_document_api_v1_document_get","security":[{"ApiKeyAuth":[]}],"parameters":[{"name":"sourceType","in":"query","required":true,"schema":{"type":"string","description":"Type of document (10-K, 10-Q, 8-K, 20-F, 40-F, 6-K, transcript, DEF 14A, DEFM14A, DEF 14C, S-1, etc.)","title":"Sourcetype"},"description":"Type of document (10-K, 10-Q, 8-K, 20-F, 40-F, 6-K, transcript, DEF 14A, DEFM14A, DEF 14C, S-1, etc.)"},{"name":"documentId","in":"query","required":true,"schema":{"type":"string","description":"UUID of the document","title":"Documentid"},"description":"UUID of the document"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/rag/chunks":{"post":{"tags":["RAG"],"summary":"Search Chunks","description":"Search for chunks based on a query.\n\nRequest body:\n- **query**: The search query (required)\n- **tickers**: Optional list of ticker symbols to filter documents by. If unsure about available tickers, \n             you can use the `/companies` endpoint to retrieve a list of all available companies and their tickers,\n             or just filter by a single ticker to see if it's available.\n- **sourceType**: Optional source type(s) to include (available options: '10-K', '10-Q', '8-K', '20-F', '40-F', '6-K', 'transcript', 'DEF 14A', etc.). \n                Can be a single string or a list of strings.\n- **startDate**: Optional start date for document filtering (format: YYYY-MM-DD)\n- **endDate**: Optional end date for document filtering (format: YYYY-MM-DD)\n- **sourceLink**: Optional source link(s) to search within. Can be a single string or a list of strings. \n                No other documents will be queried by the agent but these. Use to restrict the search to \n                user-selected documents.\n\nReturns chunks that are most relevant to the query.\n\nNote: This endpoint returns the same chunks that are used internally by the `/agent-query` endpoint.\nEach chunk contains metadata including `id` and `sourceLink` which should be preserved and returned\nwhen implementing custom answer generation based on these chunks. These fields are essential for \nproper source linking in the frontend using the Captide.js library (https://github.com/captide-tech/captidejs#readme),\nwhich allows users to view and highlight the original document sources.\n\n*Note: All JSON fields use camelCase naming convention.*","operationId":"search_chunks_api_v1_rag_chunks_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChunkSearchResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"ApiKeyAuth":[]}]}},"/api/v1/rag/agent-query-stream":{"post":{"tags":["RAG"],"summary":"Agent Query Stream","description":"Stream a response to a query in a simple markdown format.\n\nThis endpoint provides a simplified streaming response:\n1. First, it streams the ID mapping for source linking\n2. Then it streams raw markdown content as it comes from the LLM\n\nThe client only needs to concatenate the markdown chunks to get the full document,\nand can use the ID mapping to resolve citations to their sources.\n\nRequest body:\n- **query**: The query to ask the agent (required)\n- **tickers**: Optional list of ticker symbols to filter documents by\n- **sourceType**: Optional source type(s) to include (available options: '10-K', '10-Q', '8-K', '20-F', '40-F', '6-K', 'transcript', 'DEF 14A', etc.).\n                 Can be a single string or a list of strings.\n- **startDate**: Optional start date for document filtering (format: YYYY-MM-DD)\n- **endDate**: Optional end date for document filtering (format: YYYY-MM-DD)\n- **sourceLink**: Optional source link(s) to search within. Can be a single string or a list of strings.\n                 No other documents will be queried by the agent but these. Use to \n                 restrict the search to user-selected documents.\n\nReturns a streaming response with these event types:\n- 'id_mapping': A mapping of IDs to source links for citation resolution\n  ```\n  {\n    \"type\": \"id_mapping\",\n    \"mapping\": {\n      \"#uuid1234\": {\n        \"sourceLink\": \"http://rest-api.captide.co/document?id=12345678\",\n        \"sourceMetadata\": {\n          \"sourceType\": \"10-K\",\n          \"ticker\": \"AAPL\",\n          \"date\": \"2024-01-01\",\n          \"fiscalPeriod\": \"FY 2023\",\n          \"documentId\": \"12345678\"\n        }\n      }\n    }\n  }\n  ```\n\n- 'markdown_chunk': A chunk of markdown text\n  ```\n  {\n    \"type\": \"markdown_chunk\",\n    \"content\": \"This is a part of the markdown response with a citation [#uuid1234].\"\n  }\n  ```\n\n- 'warning': Notification when requested information is not found\n  ```\n  {\n    \"type\": \"warning\",\n    \"message\": \"Could not find information about X in the provided documents.\"\n  }\n  ```\n\n- 'done': Signals the end of the stream\n  ```\n  {\n    \"type\": \"done\"\n  }\n  ```\n\n- 'error': Error information if something goes wrong\n  ```\n  {\n    \"type\": \"error\",\n    \"detail\": \"An error occurred while processing the request.\"\n  }\n  ```\n\nClient implementation recommendations:\n1. First process the 'id_mapping' event to obtain source information for citations\n2. Then accumulate all 'markdown_chunk' events to build the complete response\n3. Display warnings to the user when 'warning' events are received\n4. When a 'done' event is received, the response is complete\n5. Use the ID mapping to create clickable citations in the rendered markdown\n\nIntegration with document search:\nThe 'sourceLink' parameter can be used in conjunction with the document search endpoint to:\n1. Let users search and select specific documents they want to analyze\n2. Then pass those document IDs to this endpoint to ensure the AI only references those selected documents\n3. This creates a more user-controlled research experience where they can direct the AI to specific filings\n\n*Note: All JSON fields use camelCase naming convention.*","operationId":"agent_query_stream_api_v1_rag_agent_query_stream_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"ApiKeyAuth":[]}]}},"/":{"get":{"tags":["Health"],"summary":"Root","description":"Health check endpoint.\n\n*Note: All JSON fields use camelCase naming convention.*","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"ApiKeyAuth":[]}]}}},"components":{"schemas":{"AgentRequest":{"properties":{"query":{"type":"string","title":"Query","description":"The query to ask the agent","example":"What are the key risks mentioned in the latest 10-K?"},"tickers":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Tickers","description":"List of ticker symbols to filter documents by (e.g., ['AAPL', 'MSFT']). Check the '/companies' endpoint for available tickers.","example":["AAPL","MSFT"]},"sourceType":{"anyOf":[{"type":"string"},{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Sourcetype","description":"Source type(s) to include. Available options: 10-K, 10-Q, 8-K, 20-F, 40-F, 6-K, transcript, DEF 14A, DEFM14A, DEF 14C, DEFM14C. Can be a single string or a list of strings.","example":["10-K","10-Q"]},"start_date":{"anyOf":[{"type":"string","pattern":"^\\d{4}-\\d{2}-\\d{2}$"},{"type":"null"}],"title":"Start Date","description":"Start date for document filtering (format: YYYY-MM-DD)","example":"2022-01-01"},"end_date":{"anyOf":[{"type":"string","pattern":"^\\d{4}-\\d{2}-\\d{2}$"},{"type":"null"}],"title":"End Date","description":"End date for document filtering (format: YYYY-MM-DD)","example":"2023-12-31"},"sourceLink":{"anyOf":[{"type":"string"},{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Sourcelink","description":"Source link(s) to search within. No other documents will be queried by the agent but these. Can be a single string or a list of strings. Use to restrict the search to user-selected documents."}},"additionalProperties":true,"type":"object","required":["query"],"title":"AgentRequest","description":"Request schema for streaming RAG queries."},"ApiKeyCreate":{"properties":{"name":{"type":"string","title":"Name","description":"Name of the API key"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Description of the API key's purpose"},"organization_id":{"type":"string","format":"uuid4","title":"Organization Id","description":"ID of the organization this API key belongs to"},"expires_in_days":{"anyOf":[{"type":"integer"},{"type":"string"},{"type":"null"}],"title":"Expires In Days","description":"Number of days until the API key expires. Empty string or None for no expiration."}},"type":"object","required":["name","organization_id"],"title":"ApiKeyCreate","description":"Schema for creating a new API key."},"ApiKeyDeactivate":{"properties":{"is_active":{"type":"boolean","title":"Is Active","description":"Set to false to deactivate the API key","default":false}},"type":"object","title":"ApiKeyDeactivate","description":"Schema for deactivating an API key."},"ApiKeyResponse":{"properties":{"name":{"type":"string","title":"Name","description":"Name of the API key"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Description of the API key's purpose"},"id":{"type":"string","format":"uuid4","title":"Id"},"key":{"type":"string","title":"Key"},"is_active":{"type":"boolean","title":"Is Active"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"last_used_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Used At"},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At"}},"type":"object","required":["name","id","key","is_active","created_at"],"title":"ApiKeyResponse","description":"Schema for API key response."},"ChunkSearchResponse":{"properties":{"source_chunks":{"items":{"$ref":"#/components/schemas/SourceChunk"},"type":"array","title":"Source Chunks"}},"type":"object","required":["source_chunks"],"title":"ChunkSearchResponse","description":"Response schema for chunk search results."},"CompanyListResponse":{"properties":{"name":{"type":"string","title":"Name"},"tickers":{"items":{"type":"string"},"type":"array","title":"Tickers"},"exchange":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Exchange"},"cik":{"type":"string","title":"Cik"},"delisted":{"type":"boolean","title":"Delisted","default":false}},"type":"object","required":["name","tickers","cik"],"title":"CompanyListResponse","description":"Simplified response schema for company listings."},"DocumentResponse":{"properties":{"htmlContent":{"type":"string","title":"Htmlcontent","description":"HTML content of the document"},"sourceType":{"type":"string","title":"Sourcetype","description":"Type of document (10-K, 10-Q, 8-K, transcript)"},"date":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Date","description":"Document date (filing date or transcript date)"},"fiscalPeriod":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Fiscalperiod","description":"Fiscal period of the document"},"ticker":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ticker","description":"Company ticker symbol"},"companyName":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Companyname","description":"Name of the company"}},"type":"object","required":["htmlContent","sourceType"],"title":"DocumentResponse","description":"Schema for document responses.\n\nThis represents the structure of the document data returned by various document retrieval endpoints."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"SourceChunk":{"properties":{"text":{"type":"string","title":"Text"},"text_with_ids":{"type":"string","title":"Text With Ids"},"metadata":{"type":"object","title":"Metadata"}},"additionalProperties":true,"type":"object","required":["text","text_with_ids","metadata"],"title":"SourceChunk","description":"Schema for individual chunk response."},"SourceDocument":{"properties":{"sourceType":{"type":"string","title":"Sourcetype","description":"Type of document: One of 10-K, 10-Q, 8-K, 20-F, 40-F, 6-K, transcript, DEF 14A, DEFM14A, DEF 14C, DEFM14C"},"ticker":{"type":"string","title":"Ticker","description":"Company ticker symbol"},"date":{"type":"string","title":"Date","description":"Document date (filing_date or transcript_date)"},"fiscalPeriod":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Fiscalperiod","description":"Fiscal period of the document"},"documentId":{"type":"string","title":"Documentid","description":"Unique identifier for the document in the database"},"sourceLink":{"type":"string","title":"Sourcelink","description":"Direct link to access this document via the API"},"additionalKwargs":{"type":"object","title":"Additionalkwargs","description":"Additional chunk metadata like similarity_score"}},"type":"object","required":["sourceType","ticker","date","documentId","sourceLink"],"title":"SourceDocument","description":"Unified representation of a document source (filing, transcript, etc.)."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"ApiKeyAuth":{"type":"apiKey","in":"header","name":"X-API-Key","description":"API key authentication. Enter your API key here."}}},"security":[{"ApiKeyAuth":[]}]}